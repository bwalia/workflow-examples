apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "gatus.fullname" . }}-config
  labels:
    {{- include "gatus.labels" . | nindent 4 }}
data:
  config.yaml: |
    web:
      port: {{ .Values.gatus.web.port }}

    storage:
      type: {{ .Values.gatus.storage.type }}
      path: {{ .Values.gatus.storage.path }}

    ui:
      title: {{ .Values.gatus.ui.title | quote }}
      description: {{ .Values.gatus.ui.description | quote }}
      header: {{ .Values.gatus.ui.header | quote }}
      {{- if .Values.gatus.ui.logo }}
      logo: {{ .Values.gatus.ui.logo | quote }}
      {{- end }}
      {{- if .Values.gatus.ui.link }}
      link: {{ .Values.gatus.ui.link | quote }}
      {{- end }}

    {{- if .Values.gatus.alerting }}
    alerting:
      {{- toYaml .Values.gatus.alerting | nindent 6 }}
    {{- end }}

    {{- if .Values.gatus.defaults }}
    defaults:
      {{- if .Values.gatus.defaults.endpoints }}
      endpoints:
        {{- toYaml .Values.gatus.defaults.endpoints | nindent 8 }}
      {{- end }}
    {{- end }}

    endpoints:
      {{- range .Values.gatus.endpoints }}
      - name: {{ .name | quote }}
        {{- if .group }}
        group: {{ .group | quote }}
        {{- end }}
        url: {{ .url | quote }}
        {{- if .method }}
        method: {{ .method }}
        {{- end }}
        {{- if .interval }}
        interval: {{ .interval }}
        {{- end }}
        {{- if .conditions }}
        conditions:
          {{- range .conditions }}
          - {{ . | quote }}
          {{- end }}
        {{- end }}
        {{- if .headers }}
        headers:
          {{- range $key, $value := .headers }}
          {{ $key }}: {{ $value | quote }}
          {{- end }}
        {{- end }}
        {{- if .body }}
        body: {{ .body | quote }}
        {{- end }}
        {{- if .dns }}
        dns:
          {{- toYaml .dns | nindent 10 }}
        {{- end }}
        {{- if .alerts }}
        alerts:
          {{- toYaml .alerts | nindent 10 }}
        {{- end }}
        {{- if .client }}
        client:
          {{- toYaml .client | nindent 10 }}
        {{- end }}
      {{- end }}
